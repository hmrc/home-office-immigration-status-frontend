@*
 * Copyright 2021 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import layouts.GovUkTemplate
@import play.api.Configuration
@import play.twirl.api.HtmlFormat
@import uk.gov.hmrc.homeofficesettledstatus.controllers.routes.AccessibilityStatementController
@import uk.gov.hmrc.play.views.html.helpers.ReportAProblemLink
@import uk.gov.hmrc.play.views.html.layouts._

@this(
  layoutsHead: Head, layoutsHeaderNav: HeaderNav, layoutsFooter: Footer, layoutsFooterLinks: HossFooterLinks,
  layoutsServiceInfo: ServiceInfo, layoutsMainContentHeader: MainContentHeader, layoutsMainContent: MainContent,
  helpersReportAProblemLink: ReportAProblemLink, govUkTemplate: GovUkTemplate
)

@(
  title: String,
  mainClass: Option[String] = None,
  mainDataAttributes: Option[Html] = None,
  bodyClasses: Option[String] = None,
  sidebar: Html = HtmlFormat.empty,
  contentHeader: Option[Html] = None,
  mainContent: Html = HtmlFormat.empty,
  serviceInfoContent: Html = HtmlFormat.empty,
  scriptElem: Option[Html] = None,
  gaCode: Seq[String] = Seq.empty)(implicit messages: Messages, configuration: Configuration
)

@headScripts = {
    <link href="@routes.Assets.at("stylesheets/styles.css")" media="screen" rel="stylesheet" type="text/css">
}

@scriptElement = {
    <script src="@routes.Assets.at("javascripts/scripts.js")" type="text/javascript"></script>
    <script src="@routes.Assets.at("javascripts/ga-events.js")" type="text/javascript"></script>
}

@head = {
@if(configuration.get[String]("google-tag-manager.id") != "N/A") {
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
              new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
              j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
              'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
              })(window,document,'script','dataLayer','@configuration.get[String]("google-tag-manager.id")');
        </script>
}
@layoutsHead(
    linkElem = None,
    headScripts = Some(headScripts))
    <meta name="format-detection" content="telephone=no"/>
}

@titleWithSuffix = @{ title + " - " + messages("app.titleSuffix") }

@headerNavLinks = {}

@insideHeader = {
@if(configuration.get[String]("google-tag-manager.id") != "N/A") {
<noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=@configuration.get[String]("google-tag-manager.id")" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
}
@layoutsHeaderNav(
    navTitle = Some(messages("app.name")),
    navTitleLink = None,
    showBetaLink = false,
    navLinks = Some(headerNavLinks))
}

@afterHeader = {
    <div class="centered-content">
        <div class="service-info"></div>
        <div class="beta-banner internal-beta-banner">
            <p>
                <strong class="phase-tag">ALPHA</strong>
                <span>This is a new service. Your <a id="feedback-link" href="mailto:n8n8l9g1j5c1s3i6@@hmrcdigital.slack.com" data-sso="false" data-journey-click="other-global:Click:Feedback">feedback</a> will help us to improve it.</span>
            </p>
        </div>
    </div>

}

@gaJS = {
@gaCode.map(Html(_))
}

@bodyEnd = {
@layoutsFooter(analyticsToken = Some(configuration.get[String]("google-analytics.token")),
    analyticsHost = configuration.get[String]("google-analytics.host"),
    ssoUrl = None,
    scriptElem = Some(scriptElement),
    gaCalls = None,
    analyticsAdditionalJs = Some(gaJS))
}

@footerTop = {}
@footerLinks = {
    @layoutsFooterLinks(accessibilityFooterUrl = Some(AccessibilityStatementController.showPage().url))
}

@serviceInfo = {}

@mainContentHeader = {
    @if(contentHeader.isDefined) {
        @layoutsMainContentHeader(contentHeader.get)
    }
}

@content = {
@layoutsMainContent(article = mainContent,
    mainClass = mainClass,
    mainDataAttributes = mainDataAttributes,
    mainContentHeader = mainContentHeader,
    serviceInfo = serviceInfo,
    sidebar = sidebar)
}

@govUkTemplate(Some(titleWithSuffix), bodyClasses)(head, bodyEnd, insideHeader, afterHeader, footerTop, Some(footerLinks), nav = true)(content)
